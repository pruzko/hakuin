{% set schema = schema | default(ctx.schema | sql_escape) %}

{% if ctx.target == 'schema_names' %}
    {% set table = table | default('ALL_USERS') %}
    {% set column = column | default('USERNAME') %}
{% elif ctx.target == 'table_names' %}
    {% set table = table | default('ALL_TABLES') %}
    {% set column = column | default('TABLE_NAME') %}
{% elif ctx.target == 'column_names' %}
    {% set table = table | default('ALL_TAB_COLUMNS') %}
    {% set column = column | default('COLUMN_NAME') %}
{% elif ctx.target == 'column' %}
    {% if schema %}
        {% set _table = '%s.%s' | format(schema, ctx.table | sql_escape) %}
    {% else %}
        {% set _table = ctx.table | sql_escape  %}
    {% endif %}
    {% set table = table | default(_table) %}
    {% set column = ctx.column | sql_escape %}
{% endif %}



{% block select %}
{% endblock %}


{% block from %}
    FROM    {{ table }}
{% endblock %}


{% block where %}
{% if ctx.target == 'table_names' %}
    WHERE   OWNER={{ ctx.schema | sql_str_lit if ctx.schema else 'USER' }}
{% elif ctx.target == 'column_names' %}
    WHERE   OWNER={{ ctx.schema | sql_str_lit if ctx.schema else 'USER' }}
            AND
            TABLE_NAME={{ ctx.table | sql_str_lit }}
{% endif %}
{% endblock %}


{% block offset %}
{% if single_row %}
    ORDER BY    (SELECT NULL)
    OFFSET      {{ ctx.row_idx }} ROWS
    FETCH NEXT  1 ROWS ONLY
{% endif %}
{% endblock %}