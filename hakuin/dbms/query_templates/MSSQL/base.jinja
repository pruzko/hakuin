{% set schema = schema | default(ctx.schema | sql_ident) %}

{% if ctx.target == 'schema_names' %}
    {% set table = table | default('INFORMATION_SCHEMA.SCHEMATA') %}
    {% set column = column | default('SCHEMA_NAME') %}
{% elif ctx.target == 'table_names' %}
    {% set table = table | default('INFORMATION_SCHEMA.TABLES') %}
    {% set column = column | default('TABLE_NAME') %}
{% elif ctx.target == 'column_names' %}
    {% set table = table | default('INFORMATION_SCHEMA.COLUMNS') %}
    {% set column = column | default('COLUMN_NAME') %}
{% elif ctx.target == 'column' %}
    {% if schema %}
        {% set _table = '%s.%s' | format(schema, ctx.table | sql_ident) %}
    {% else %}
        {% set _table = ctx.table | sql_ident  %}
    {% endif %}
    {% set table = table | default(_table) %}
    {% set column = ctx.column | sql_ident %}
{% endif %}



{% block select %}
{% endblock %}


{% block from %}
    FROM    {{ table }}
{% endblock %}


{% block where %}
{% if ctx.target == 'table_names' %}
    WHERE   TABLE_SCHEMA={{ ctx.schema | sql_lit if ctx.schema else 'schema_name()' }}
            AND
            TABLE_TYPE='BASE TABLE'
{% elif ctx.target == 'column_names' %}
    WHERE   TABLE_SCHEMA={{ ctx.schema | sql_lit if ctx.schema else 'schema_name()' }}
            AND
            TABLE_NAME={{ ctx.table | sql_lit }}
{% endif %}
{% endblock %}


{% block offset %}
{% if single_row %}
    ORDER BY    (SELECT NULL)
    OFFSET      {{ ctx.row_idx }} ROWS
    FETCH NEXT  1 ROWS ONLY
{% endif %}
{% endblock %}