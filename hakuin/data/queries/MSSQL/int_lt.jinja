{% set column = ctx.column | sql_escape %}
{% set table = ctx.table | sql_escape %}
{% set row_number_alias = 'i' if column != 'i' else '_i' %}
{% set table_alias = 't' if table != 't' else '_t' %}


SELECT  CASE WHEN {{ column }} < {{ n }} THEN 1 ELSE 0 END
FROM    (
        SELECT  row_number() OVER (ORDER BY {{ column | sql_to_varchar }} ASC) as {{ row_number_alias }}, {{ column }}
        FROM    {{ table }}
)
AS      {{ table_alias }}
WHERE   {{ row_number_alias }} = {{ ctx.row_idx + 1 }}